# AI Wallet 実装ドキュメント

## 概要
AIによって制御されるWeb3ウォレットの実装。ユーザーはチャットインターフェースを通じてAIと対話しながら、ウォレットの作成や管理を行うことができます。

## 現在の実装状況

### 1. スマートコントラクト (AIAgentWallet.sol)
- 機能:
  - AIエージェントによる制御
  - 日次送金制限
  - ホワイトリスト管理
  - ウォレットのロック/アンロック
  - 緊急時の資金引き出し

### 2. フロントエンド実装
#### チャットUI (index.tsx)
- 機能:
  - AIとの自然な対話インターフェース
  - ウォレット操作のガイダンス
  - エラー表示とリカバリー
  - 操作履歴の表示

#### ウォレット管理 (AIWallet.ts)
- 機能:
  - ウォレットの作成と初期化
  - トランザクションの実行
  - 残高管理
  - セキュリティ情報の管理

### 3. バックエンド連携
#### AIエージェント (ai-agent.ts)
- 機能:
  - ユーザーの意図解釈
  - ウォレット操作の実行
  - セキュリティチェック
  - エラーハンドリング

### 4. 管理者機能
#### 管理者ウォレット
- アドレス: 0x2CacAbF77C7aE00671E4D81E197672D6042092f0
- 機能:
  - ガス代の管理
  - スマートコントラクトの制御
  - 緊急時の操作

#### 管理ツール
1. create-admin-wallet.js
   - 管理者ウォレットの作成
   - セキュリティ情報の生成
   - 環境変数の設定

2. check-balance.js
   - メインネット残高の確認
   - Sepoliaテストネット残高の確認
   - フォーセット要件の確認

## ユーザーフロー

1. ウォレット作成
```
ユーザー → AIチャット → "ウォレットを作成したい"
↓
AI: ウォレット作成プロセスの説明
↓
ユーザー: 承認
↓
システム: 
- スマートコントラクトのデプロイ
- ウォレットアドレスの生成
- セキュリティ情報の提供
```

2. 残高確認
```
ユーザー → AIチャット → "残高を確認したい"
↓
AI: 現在の残高を表示
- ETH残高
- トークン残高(実装予定)
- 取引履歴(実装予定)
```

3. 送金操作
```
ユーザー → AIチャット → "送金したい"
↓
AI: 送金先と金額の確認
↓
システム:
- 日次制限のチェック
- セキュリティチェック
- トランザクションの実行
```

## セキュリティ機能

1. トランザクション制限
- 日次送金上限
- ホワイトリストアドレス
- ロック機能

2. 管理者権限
- スマートコントラクトの制御
- 緊急時の資金回収
- 設定の変更

3. エラー処理
- トランザクション失敗の処理
- ガス不足の検知
- ネットワークエラーのハンドリング

## 今後の実装予定

1. Account Abstraction
- Alchemyの`Gas Manager API`を使用
- ユーザーフレンドリーなガス代管理
- スマートアカウントの実装

2. トークン管理
- ERC20トークンのサポート
- トークン残高の表示
- トークン送金機能

3. 取引履歴
- トランザクション履歴の表示
- 取引の詳細情報
- エクスポート機能

4. セキュリティ強化
- マルチシグ機能
- 取引制限の詳細設定
- セキュリティアラート

## 技術スタック

- フロントエンド: Next.js, React
- スマートコントラクト: Solidity
- ブロックチェーン連携: ethers.js
- AI連携: OpenAI API
- インフラ: Alchemy API

## 環境設定

必要な環境変数:
```
NEXT_PUBLIC_ALCHEMY_API_KEY=
NEXT_PUBLIC_ADMIN_WALLET_ADDRESS=
ADMIN_PRIVATE_KEY=
```

## 開発環境

- ネットワーク: Sepolia Testnet
- 管理者ウォレット残高:
  - メインネット: 0.0011 ETH
  - Sepolia: 0.1 ETH